Module("libspoofax/term/position",[Signature([Constructors([OpDecl("MARKER",ConstType(SortNoArgs("Term")))])]),Strategies([SDefT("desugar-position",[VarDec("desugar",ConstType(SortNoArgs("ATerm")))],[VarDec("ast",ConstType(SortNoArgs("ATerm")))],SRule(Rule(Var("position"),Var("position'"),[WhereClause(Seq(Assign(Var("ast'"),App(CallT(SVar("at-position"),[Build(AnnoList(RootApp(Id),[NoAnnoList(Op("MARKER",[]))]))],[Var("position")]),Var("ast"))),Seq(Assign(Var("ast''"),App(CallT(SVar("topdown"),[CallT(SVar("repeat"),[CallT(SVar("preserve-annos"),[ScopeDefault(Seq(Match(Var("x")),Seq(CallT(SVar("desugar"),[],[]),Not(Match(Var("x"))))))],[])],[])],[]),Var("ast'"))),Assign(Var("position'"),App(CallT(SVar("position-of-term"),[ScopeDefault(Seq(Match(AnnoList(Wld,[Var("a*")])),BA(One(Match(NoAnnoList(Op("MARKER",[])))),Var("a*"))))],[]),Var("ast''"))))))]))),SDefT("at-position",[VarDec("s",ConstType(SortNoArgs("ATerm")))],[VarDec("position",ConstType(SortNoArgs("ATerm")))],SRule(Rule(NoAnnoList(Explode(Var("c"),Var("t*"))),Var("t'"),[WhereClause(AM(Build(Var("position")),NoAnnoList(ListTail([Var("i")],Var("position'"))))),WhereClause(Assign(Var("t'"),NoAnnoList(Explode(Var("c"),App(CallT(SVar("at-index"),[CallT(SVar("at-position"),[CallT(SVar("s"),[],[])],[Var("position'")])],[]),NoAnnoList(Tuple([Var("i"),Var("t*")])))))))]))),SDefT("at-position",[VarDec("s",ConstType(SortNoArgs("ATerm")))],[VarDec("position",ConstType(SortNoArgs("ATerm")))],SRule(Rule(Var("t"),Var("t'"),[WhereClause(Seq(AM(Build(Var("position")),NoAnnoList(List([]))),Assign(Var("t'"),App(CallT(SVar("s"),[],[]),Var("t")))))]))),SDefT("position-of-term",[VarDec("is-term",ConstType(SortNoArgs("ATerm")))],[],SRule(Rule(Var("t"),NoAnnoList(List([])),[WhereClause(CallT(SVar("is-term"),[],[]))]))),SDefT("position-of-term",[VarDec("is-term",ConstType(SortNoArgs("ATerm")))],[],SRule(Rule(NoAnnoList(Explode(Wld,Var("t*"))),App(CallT(SVar("position-of-term"),[CallT(SVar("is-term"),[],[])],[NoAnnoList(Int("0"))]),Var("t*")),[WhereClause(Not(CallT(SVar("is-term"),[],[])))]))),SDefT("position-of-term",[VarDec("is-term",ConstType(SortNoArgs("ATerm")))],[VarDec("start-index",ConstType(SortNoArgs("ATerm")))],SRule(Rule(NoAnnoList(ListTail([Var("t")],Var("t*"))),Var("position"),[WhereClause(GuardedLChoice(Where(Assign(Var("i*"),App(CallT(SVar("position-of-term"),[CallT(SVar("is-term"),[],[])],[]),Var("t")))),Assign(Var("position"),NoAnnoList(ListTail([Var("start-index")],Var("i*")))),Assign(Var("position"),App(CallT(SVar("position-of-term"),[CallT(SVar("is-term"),[],[])],[App(CallT(SVar("inc"),[],[]),Var("start-index"))]),Var("t*")))))]))),SDefT("term-at-position",[],[VarDec("position",ConstType(SortNoArgs("ATerm")))],SRule(Rule(Var("t"),Var("t'"),[WhereClause(CallT(SVar("at-position"),[Match(Var("t'"))],[Var("position")]))]))),SDefT("parent-at-position",[],[VarDec("position",ConstType(SortNoArgs("ATerm")))],SRule(Rule(Var("t"),Var("t'"),[WhereClause(Seq(AM(Build(Var("position")),NoAnnoList(List([Var("i"),Wld]))),Assign(Var("t'"),App(CallT(SVar("subterm-at"),[],[Var("i")]),Var("t")))))]))),SDefT("parent-at-position",[],[VarDec("position",ConstType(SortNoArgs("ATerm")))],SRule(Rule(Var("t"),App(CallT(SVar("parent-at-position"),[],[Var("position'")]),Var("t'")),[WhereClause(Seq(AM(Build(Var("position")),NoAnnoList(ListTail([Var("i")],As(Var("position'"),NoAnnoList(ListTail([Wld,Wld],Wld)))))),Assign(Var("t'"),App(CallT(SVar("subterm-at"),[],[Var("i")]),Var("t")))))]))),SDefT("subterm-at",[],[VarDec("index",ConstType(SortNoArgs("ATerm")))],SRule(Rule(NoAnnoList(Explode(Wld,Var("t*"))),App(CallT(SVar("index"),[],[App(CallT(SVar("inc"),[],[]),Var("index"))]),Var("t*")),[])))])])